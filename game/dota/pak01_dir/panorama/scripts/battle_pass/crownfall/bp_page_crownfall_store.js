"use strict";
/// <reference path="../../dota.d.ts" />
/// <reference path="../../common/async.ts" />
function FindChildrenOfTypeTraverse(parent, panelType) {
    var children = [];
    for (var i = 0; i < parent.GetChildCount(); ++i) {
        var child = parent.GetChild(i);
        if (child.paneltype == panelType) {
            children.push(child);
        }
        children.push(...FindChildrenOfTypeTraverse(child, panelType));
    }
    return children;
}
function OnSelectedItemChanged() {
    const carousel = $('#StoreCarousel');
    const selected = carousel.GetFocusChild();
    var nChildren = carousel.GetChildCount();
    for (var i = 0; i < nChildren; ++i) {
        var storeItem = carousel.GetChild(i);
        var purchaseButtons = FindChildrenOfTypeTraverse(storeItem, "DOTACrownfallPurchaseButton");
        for (var button of purchaseButtons) {
            const purchaseButton = button;
            purchaseButton.isStoreItemFocused = (storeItem == selected);
        }
    }
}
function OnPageLoad() {
    const carousel = $('#StoreCarousel');
    $.RegisterEventHandler('SetCarouselSelectedChild', carousel, OnSelectedItemChanged);
}
var g_nDiscoSoundGuid = 0;
function SetDiscountModeActive(bActive) {
    if (g_nDiscoSoundGuid) {
        StopUISoundScript(g_nDiscoSoundGuid);
        g_nDiscoSoundGuid = 0;
    }
    const pScene = $('#DiscountModePageFX');
    const pSceneForeground = $('#DiscountModePageFXForeground');
    if (bActive) {
        $.GetContextPanel().AddClass('DiscountActive');
        pScene.FireEntityInput("background_fx", "Start", "1");
        pSceneForeground.FireEntityInput("foreground_fx", "Start", "1");
        g_nDiscoSoundGuid = PlayUISoundScript('crownfall_store_disco');
    }
    else {
        $.GetContextPanel().RemoveClass('DiscountActive');
        pScene.FireEntityInput("background_fx", "StopPlayEndCap", "1");
        pSceneForeground.FireEntityInput("foreground_fx", "StopPlayEndCap", "1");
    }
}
var SetupTreasurePreview_I = function () {
    const pScene = $('#TreasurePreview_I');
    pScene.FireEntityInput('hero_cm', 'SetPlaybackRateOnAllLayers', 0.8);
    pScene.FireEntityInput('hero_wk', 'SetPlaybackRateOnAllLayers', 0.8);
    pScene.FireEntityInput('hero_meepo', 'SetPlaybackRateOnAllLayers', 0.7);
};
var SetupTreasurePreview_II = function () {
    const pScene = $('#TreasurePreview_II');
    pScene.FireEntityInput('hero_ursa', 'SetPlaybackRateOnAllLayers', 0.3);
    pScene.FireEntityInput('hero_drow', 'SetPlaybackRateOnAllLayers', 0.7);
    pScene.FireEntityInput('hero_hoodwink', 'SetPlaybackRateOnAllLayers', 0.4);
};
var SetupTreasurePreview_III = function () {
    const pScene = $('#TreasurePreview_III');
    pScene.FireEntityInput('hero_antimage', 'SetPlaybackRateOnAllLayers', 0.3);
    pScene.FireEntityInput('hero_phantom_lancer', 'SetPlaybackRateOnAllLayers', 0.7);
    pScene.FireEntityInput('hero_oracle', 'SetPlaybackRateOnAllLayers', 0.4);
};
var SetupTreasurePreview_Cache = function () {
    const pScene = $('#TreasurePreview_Cache');
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYnBfcGFnZV9jcm93bmZhbGxfc3RvcmUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi9jb250ZW50L2RvdGEvcGFub3JhbWEvc2NyaXB0cy9iYXR0bGVfcGFzcy9jcm93bmZhbGwvYnBfcGFnZV9jcm93bmZhbGxfc3RvcmUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLHdDQUF3QztBQUN4Qyw4Q0FBOEM7QUFROUMsU0FBUywwQkFBMEIsQ0FBRSxNQUFlLEVBQUUsU0FBaUI7SUFFbkUsSUFBSSxRQUFRLEdBQW1CLEVBQUUsQ0FBQztJQUVsQyxLQUFNLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsTUFBTSxDQUFDLGFBQWEsRUFBRSxFQUFFLEVBQUUsQ0FBQyxFQUNoRDtRQUNJLElBQUksS0FBSyxHQUFZLE1BQU0sQ0FBQyxRQUFRLENBQUUsQ0FBQyxDQUFFLENBQUM7UUFFMUMsSUFBSyxLQUFLLENBQUMsU0FBUyxJQUFJLFNBQVMsRUFDakM7WUFDSSxRQUFRLENBQUMsSUFBSSxDQUFFLEtBQUssQ0FBRSxDQUFDO1NBQzFCO1FBRUQsUUFBUSxDQUFDLElBQUksQ0FBRSxHQUFHLDBCQUEwQixDQUFFLEtBQUssRUFBRSxTQUFTLENBQUUsQ0FBRSxDQUFDO0tBQ3RFO0lBRUQsT0FBTyxRQUFRLENBQUM7QUFDcEIsQ0FBQztBQUdELFNBQVMscUJBQXFCO0lBRTFCLE1BQU0sUUFBUSxHQUFlLENBQUMsQ0FBRSxnQkFBZ0IsQ0FBRSxDQUFDO0lBQ25ELE1BQU0sUUFBUSxHQUFZLFFBQVEsQ0FBQyxhQUFhLEVBQUUsQ0FBQztJQUVuRCxJQUFJLFNBQVMsR0FBVyxRQUFRLENBQUMsYUFBYSxFQUFFLENBQUM7SUFDakQsS0FBTSxJQUFJLENBQUMsR0FBVyxDQUFDLEVBQUUsQ0FBQyxHQUFHLFNBQVMsRUFBRSxFQUFFLENBQUMsRUFDM0M7UUFDSSxJQUFJLFNBQVMsR0FBWSxRQUFRLENBQUMsUUFBUSxD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