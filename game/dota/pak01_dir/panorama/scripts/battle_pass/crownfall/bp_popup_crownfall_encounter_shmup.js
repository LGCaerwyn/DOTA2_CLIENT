"use strict";
/// <reference path="../../dota.d.ts" />
/// <reference path="../../common/async.ts" />
let gGameStateAsyncAbort = null;
let gUIEventAsyncAbort = null;
let gVersion = 0;
;
;
;
let gVictoryInfo = null;
const kState = {
    Attract: 0,
    Running: 1,
    Paused: 2,
    GameOver: 3,
    Victory: 4
};
function _CancelUIAnimations() {
    if (gUIEventAsyncAbort !== null) {
        gUIEventAsyncAbort.abort();
        gUIEventAsyncAbort = null;
    }
    const panel = $.GetContextPanel();
    if (!panel)
        return;
    panel.RemoveClass("BossWarning_Active");
    panel.RemoveClass("BossWarning_Show");
    panel.RemoveClass("BossWarning_PlayAnimation");
    panel.RemoveClass("BossWarning_PlaySubtitleAnimation");
}
function _RunUIAnimation(animFunc) {
    _CancelUIAnimations();
    const panel = $.GetContextPanel();
    gUIEventAsyncAbort = new Async.AbortController();
    Async.RunSequence(function* (abortSignal) { yield* animFunc(panel, abortSignal); }, gUIEventAsyncAbort.signal);
}
function _CancelStateAnimations() {
    if (gGameStateAsyncAbort !== null) {
        gGameStateAsyncAbort.abort();
        gGameStateAsyncAbort = null;
    }
    const panel = $.GetContextPanel();
    if (!panel)
        return;
    panel.RemoveClass("ShowGameOverFade");
    panel.RemoveClass("ShowGameOverText");
    panel.RemoveClass("ShowGameOverButton");
    panel.RemoveClass("Victory_Active");
    panel.RemoveClass("Victory_Show");
    panel.RemoveClass("Victory_Title");
    panel.RemoveClass("Victory_PerformanceSummary");
    panel.RemoveClass("Victory_ScoreTitle");
    panel.RemoveClass("Victory_ScoreValue");
    panel.RemoveClass("Victory_ComboTitle");
    panel.RemoveClass("Victory_ComboValue");
    panel.RemoveClass("Victory_RatingTitle");
    panel.RemoveClass("Victory_RatingValue");
    panel.RemoveClass("Victory_ShowButtons");
    const scoreCategories = panel.FindChildInLayoutFile("VictoryCategories");
    if (scoreCategories) {
        scoreCategories.RemoveAndDeleteChildren();
    }
}
function _RunStateAnimation(animFunc) {
    _CancelStateAnimations();
    _CancelUIAnimations();
    const panel = $.GetContextPanel();
    gGameStateAsyncAbort = new Async.AbortController();
    Async.RunSequence(function* (abortSignal) { yield* animFunc(panel, abortSignal); }, gGameStateAsyncAbort.signal);
}
function* _GameOverAnimation(panel) {
    yield Async.Delay(1.5);
    panel.AddClass("ShowGameOverFade");
    yield Async.Delay(1.5);
    panel.AddClass("ShowGameOverText");
    yield Async.Delay(1);
    panel.AddClass("ShowGameOverButton");
}
function DebugScoreInfo(score, token) {
    return { token: token, score: score, score_per_instance: 0 };
}
const kDebugVictoryInfo = {
    total_score: 513500 + 1838 + 424600 + 500000 + 160000 + 49000,
    scores: [
        DebugScoreInfo(513500, '#DOTA_Crownfall_Shmup_ScoreCategory_EnemyKill'),
        DebugScoreInfo(1838, '#DOTA_Crownfall_Shmup_ScoreCategory_Damage'),
        DebugScoreInfo(424600, '#DOTA_Crownfall_Shmup_ScoreCategory_Combo'),
        DebugScoreInfo(500000, '#DOTA_Crownfall_Shmup_ScoreCategory_BossKill'),
        DebugScoreInfo(160000, '#DOTA_Crownfall_Shmup_ScoreCategory_RemainingLives'),
        DebugScoreInfo(49000, '#DOTA_Crownfall_Shmup_ScoreCategory_RemainingTime'),
    ]
};
function* _VictoryAnimation(panel, abortSignal) {
    var victoryInfo;
    if (gVictoryInfo) {
        victoryInfo = gVictoryInfo;
    }
    else {
        $.Warning('shmup victory screen with no score info\n');
        victoryInfo = kDebugVictoryInfo;
    }
    var bScoreUpdateInProgress = true;
    var nCurrentScore = 0;
    function* ScoreAnim() {
        var nDisplayedScore = 0;
        var nDisplayedScorePerTick = 0;
        var msLast = Date.now();
        var msLeftover = 0;
        var sfx = null;
        const SCORE_TICKS = 23;
        const MS_PER_TICK = 1000.0 / 60.0;
        panel.SetDialogVariableInt("victory_score", nDisplayedScore);
        while (nCurrentScore > nDisplayedScore || bScoreUpdateInProgress) {
            yield Async.NextFrame();
            const msCurrent = Date.now();
            msLeftover += msCurrent - msLast;
            msLast = msCurrent;
            if (nCurrentScore > nDisplayedScore) {
                var nTicks = Math.floor(msLeftover / MS_PER_TICK);
                msLeftover %= MS_PER_TICK;
                if (!sfx) {
                    sfx = PlayUISoundScript('XP.Count');
                }
                if (nTicks > 0) {
                    const diff = nCurrentScore - nDisplayedScore;
                    nDisplayedScorePerTick = Math.max(nDisplayedScorePerTick, Math.ceil(diff / SCORE_TICKS));
                    nDisplayedScore = Math.min(nCurrentScore, nDisplayedScore + nDisplayedScorePerTick * nTicks);
                    panel.SetDialogVariableInt("victory_score", nDisplayedScore);
                }
            }
            else {
                nDisplayedScorePerTick = 0;
                msLeftover = 0;
                if (sfx) {
                    StopUISoundScript(sfx);
                    sfx = null;
                }
            }
        }
        if (sfx) {
            StopUISoundScript(sfx);
            sfx = null;
        }
        panel.SetDialogVariableInt("victory_score", nCurrentScore);
    }
    Async.RunSequence(ScoreAnim, abortSignal);
    yield Async.Delay(1.5);
    panel.AddClass("Victory_Active");
    panel.AddClass("ShowGameOverFade");
    yield Async.Delay(2);
    panel.AddClass("Victory_Show");
    yield Async.Delay(1);
    panel.AddClass("Victory_Title");
    yield Async.Delay(2);
    panel.AddClass("Victory_PerformanceSummary");
    yield Async.Delay(1);
    panel.AddClass("Victory_ComboTitle");
    yield Async.Delay(0.3);
    panel.AddClass("Victory_ComboValue");
    yield Async.Delay(0.3);
    panel.AddClass("Victory_ScoreTitle");
    yield Async.Delay(0.3);
    panel.AddClass("Victory_ScoreValue");
    yield Async.Delay(0.1);
    const scoreCategories = panel.FindChildInLayoutFile("VictoryCategories");
    if (scoreCategories) {
        scoreCategories.RemoveAndDeleteChildren();
        for (const scoreItem of victoryInfo.scores) {
            var scoreItemPanel = $.CreatePanel('Panel', scoreCategories, undefined);
            scoreItemPanel.BLoadLayoutSnippet('VictoryScoreItem');
            scoreItemPanel.SetDialogVariableLocString('item_name', scoreItem.token);
            scoreItemPanel.SetDialogVariableInt('item_score', scoreItem.score);
            yield Async.NextFrame();
            scoreItemPanel.AddClass('ShowScoreItem');
            yield Async.Delay(0.6);
            nCurrentScore += scoreItem.score;
            yield Async.Delay(0.1);
        }
    }
    nCurrentScore = victoryInfo.total_score;
    $.Msg('Current score: ' + nCurrentScore);
    bScoreUpdateInProgress = false;
    yield Async.Delay(0.3);
    yield Async.Delay(1);
    panel.AddClass("Victory_RatingTitle");
    yield Async.Delay(2);
    panel.AddClass("Victory_RatingValue");
    yield Async.Delay(0.8);
    panel.TriggerClass("CameraShake");
    $.DispatchEvent('PlaySoundEffect', 'HeroBadgeLevelUpReward.ShowReward');
    yield Async.Delay(2);
    panel.AddClass("Victory_ShowButtons");
    panel.NotifyVictoryScreenComplete();
}
function UIStateChange(eState) {
    if (gVersion != $.GetContextPanel().GetAttributeInt('scriptversion', 0)) {
        return;
    }
    $.Msg('SHMUP: changing to game_state ' + eState);
    if (eState == kState.GameOver) {
        _RunStateAnimation(_GameOverAnimation);
    }
    else if (eState == kState.Victory) {
        _RunStateAnimation(_VictoryAnimation);
    }
    else {
        _CancelStateAnimations();
        _CancelUIAnimations();
    }
}
function* _BossWarningAnimation(panel) {
    panel.AddClass("BossWarning_Active");
    yield Async.NextFrame();
    panel.AddClass("BossWarning_Show");
    yield Async.Delay(0.6);
    $.DispatchEvent('PlaySoundEffect', 'crownfall.shmup.boss.warning');
    panel.AddClass("BossWarning_PlayAnimation");
    yield Async.Delay(0.3);
    panel.AddClass("BossWarning_PlaySubtitleAnimation");
    yield Async.Delay(6);
    panel.RemoveClass("BossWarning_Show");
    yield Async.Delay(1);
    panel.RemoveClass("BossWarning_PlayAnimation");
    panel.RemoveClass("BossWarning_PlaySubtitleAnimation");
    yield Async.NextFrame();
    panel.RemoveClass("BossWarning_Active");
}
function BossWarning() {
    $.Msg('SHMUP: boss warning');
    _RunStateAnimation(_BossWarningAnimation);
}
function PopulateVictoryScreen(info) {
    gVictoryInfo = info;
}
function OnScriptLoad() {
    _CancelUIAnimations();
    const panel = $.GetContextPanel();
    if (panel) {
        gVersion = panel.GetAttributeInt('scriptversion', 0) + 1;
        panel.SetAttributeInt('scriptversion', gVersion);
        $.Schedule(0.1, () => UIStateChange(panel.game_state));
    }
}
OnScriptLoad();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYnBfcG9wdXBfY3Jvd25mYWxsX2VuY291bnRlcl9zaG11cC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL2NvbnRlbnQvZG90YS9wYW5vcmFtYS9zY3JpcHRzL2JhdHRsZV9wYXNzL2Nyb3duZmFsbC9icF9wb3B1cF9jcm93bmZhbGxfZW5jb3VudGVyX3NobXVwLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSx3Q0FBd0M7QUFDeEMsOENBQThDO0FBRTlDLElBQUksb0JBQW9CLEdBQWlDLElBQUksQ0FBQztBQUM5RCxJQUFJLGtCQUFrQixHQUFpQyxJQUFJLENBQUM7QUFDNUQsSUFBSSxRQUFRLEdBQVcsQ0FBQyxDQUFDO0FBTXhCLENBQUM7QUFRRCxDQUFDO0FBTUQsQ0FBQztBQUVGLElBQUksWUFBWSxHQUFvQyxJQUFJLENBQUM7QUFFekQsTUFBTSxNQUFNLEdBQUc7SUFDWCxPQUFPLEVBQUUsQ0FBQztJQUNWLE9BQU8sRUFBRSxDQUFDO0lBQ1YsTUFBTSxFQUFFLENBQUM7SUFDVCxRQUFRLEVBQUUsQ0FBQztJQUNYLE9BQU8sRUFBRSxDQUFDO0NBQ2IsQ0FBQztBQUdGLFNBQVMsbUJBQW1CO0lBRXhCLElBQUssa0JBQWtCLEtBQUssSUFBSSxFQUNoQztRQUNJLGtCQUFrQixDQUFDLEtBQUssRUFBRSxDQUFDO1FBQzNCLGtCQUFrQixHQUFHLElBQUksQ0FBQztLQUM3QjtJQUVELE1BQU0sS0FBSyxHQUFHLENBQUMsQ0FBQyxlQUFlLEVBQUUsQ0FBQztJQUNsQyxJQUFLLENBQUMsS0FBSztRQUNQLE9BQU87SUFHWCxLQUFLLENBQUMsV0FBVyxDQUFFLG9CQUFvQixDQUFFLENBQUM7SUFDMUMsS0FBSyxDQUFDLFdBQVcsQ0FBRSxrQkFBa0IsQ0FBRSxDQUFDO0lBQ3hDLEtBQUssQ0FBQyxXQUFXLENBQUUsMkJBQTJCLENBQUUsQ0FBQztJQUNqRCxLQUFLLENBQUMsV0FBVyxDQUFFLG1DQUFtQyxDQUFFLENB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